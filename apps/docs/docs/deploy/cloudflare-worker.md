# Cloudflare Worker

> Looking for a quick start? See [Getting Started - Cloudflare](../getting-started/cloudflare).

Run Mokup in Workers with `mokup/server/fetch`. The `mokup/server/worker` entry
is still available for a more compact Worker wrapper.

## 1. Worker entry (virtual bundle)

When you use `mokup/vite`, import the virtual bundle generated by Vite:

```ts
import { createMokupWorker } from 'mokup/server/worker'
import mokupBundle from 'virtual:mokup-bundle'

export default createMokupWorker(mokupBundle)
```

## 2. Wrangler config

```jsonc
{
  "name": "web-mokup-worker",
  "main": "worker/src/index.ts",
  "compatibility_date": "2025-01-15"
}
```

## 3. Build & deploy

```bash
vite dev
vite build
wrangler deploy
```

No extra `moduleBase` or `moduleMap` wiring is required when using the bundle.

If you prefer the fetch handler, wire it manually:

```ts
import { createFetchHandler } from 'mokup/server/fetch'
import mokupBundle from 'virtual:mokup-bundle'

const handler = createFetchHandler({
  manifest: mokupBundle.manifest,
  moduleMap: mokupBundle.moduleMap,
  moduleBase: mokupBundle.moduleBase,
})

export default {
  fetch: async (request: Request) => {
    return (await handler(request)) ?? new Response('Not Found', { status: 404 })
  },
}
```
